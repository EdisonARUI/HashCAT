# HashCAT 用户故事汇总文档  
**Version: v1.1.3** | **Last Updated: 2025-03-22**  

---

## 一、核心模块故事集

### 模块1：跨链基础设施
#### Story #009 跨链桥模拟器
**角色**：测试矿工  
**需求**：在测试网实现BTC→Sui的资产跨链模拟  
**开发任务**：
- ✅ sBTC铸币合约（Move语言实现）
- ✅ 地址映射注册表（BTC↔Sui地址关联）
- ⏳ 跨链交易监控看板（实时显示交易队列状态）

**技术细节**：
```move
public entry fun register_address(
    btc_addr: vector<u8>, 
    sui_addr: address
) {
    mappings[btc_addr] = sui_addr;
}
```

---

### 模块2：保险协议核心
#### Story #001 投保合约基础框架
**角色**：矿工  
**需求**：创建标准化投保合约模板  
**关键参数**：  
$$
Premium = 0.05 \times sBTC + \frac{Volatility^2}{2}
$$

#### Story #002 投保参数配置（修订版）
**变更点**：
1. 删除风险层级选择器
2. 新增跨链进度可视化组件
3. 集成TWAP价格预言机

#### Story #005 赔付执行系统
**赔付优先级**：
1. 保险池储备金（70% sBTC）
2. 债券池流动性（30% sBTC）
3. 应急清算机制（触发条件：池覆盖率 < 85%）

---

### 模块3：债券池经济模型
#### Story #010 债券池AMM机制
**角色**：流动性提供者  
**核心算法**：恒定乘积公式  
$$
k = sBTC_{储备} \times Bond_{总量}
$$

**交易类型**：
| 操作 | 公式 |
|------|------|
| 购买 | $Bond_{获得} = \frac{sBTC_{投入} \times Bond_{总量}}{sBTC_{储备} + sBTC_{投入}}$ |
| 赎回 | $sBTC_{获得} = \frac{Bond_{赎回} \times sBTC_{储备}}{Bond_{总量}}$ |

---

## 二、辅助系统故事集
#### Story #007 风险控制面板
**监控指标**：
- 实时算力波动率（±15%阈值告警）
- 债券池健康度评分（0-100动态指数）
- 跨链延迟热力图（5分钟粒度）

#### Story #012 合规审计接口
**集成功能**：
- ✅ 交易行为分析（反洗钱模式）
- ✅ 地域访问限制（屏蔽监管黑名单地区）
- ⏳ 自动监管报告生成（SEC/MAS格式）

---

## 三、测试网专项故事
#### Story #015 跨链故障模拟
**测试场景**：
1. 双花攻击回滚测试
2. 网络延迟压力测试（>60分钟交易卡顿）
3. 桥接合约升级兼容性验证

#### Story #017 NFT元数据验证器
**校验逻辑**：
```python
def validate_nft(nft):
    assert nft['hashrate'] == ChainlinkOracle.get_hashrate()
    assert nft['expire_time'] > time.time() + 86400
```

---

## 四、开发优先级矩阵
| 故事ID | 紧急度 | 技术难度 | 预计工时 |
|--------|--------|----------|----------|
| #009   | 🔴高    | ⚫️⚫️⚫️⚪️  | 3人日    |
| #010   | 🟡中    | ⚫️⚫️⚫️⚫️  | 5人日    |
| #002   | 🟢低    | ⚫️⚫️⚪️⚪️  | 1.5人日  |
| #015   | 🔴高    | ⚫️⚫️⚫️⚪️  | 2人日    |

---

## 文档说明
1. **符号说明**：
   - ✅ 已完成开发
   - ⏳ 开发中任务
   - 🔴/🟡/🟢 紧急度标识
   - ⚫️ 技术难度等级（⚫️=1级）

2. **公式规范**：
   - 所有数学公式使用KaTeX语法
   - 变量用斜体表示（如$sBTC_{储备}$）

3. **编辑建议**：
   - 推荐使用Typora/VSCode等支持实时预览的编辑器
   - 如需导出PDF，建议使用`pandoc`转换工具
``` 

### 格式特点说明：
1. **分层结构**：通过`#`和`##`实现多级标题嵌套
2. **代码高亮**：使用三个反引号标注技术实现细节
3. **数学公式**：支持动态渲染的KaTeX表达式
4. **状态标识**：采用Unicode符号实现可视化状态标记
5. **表格对齐**：管道符表格支持复杂内容排版
6. **版本控制**：顶部显式标注文档版本和更新时间
